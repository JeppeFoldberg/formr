```{r eval=TRUE,echo=FALSE}
if (!exists("indent")) {
	indent = '###' # ugly hack so _regression_summary can be "spun" (variables included via `r ` have to be available)
}
if (exists("testing")) {
	item = 1:10
}
item_info = attributes(item)$item
item_name = item_info$name
item_label = ifelse(is.null(item_info$label), "", item_info$label)
choices = item_info$choices
```

`r indent` `r item_name` {#`r item_name` .tabset}

`r indent`# Distribution {#`r item_name`_distribution}
```{r}
old_width = knitr::opts_chunk$get("fig.width")
knitr::opts_chunk$set(fig.width = 1.5 * length(choices))
```
```{r}
dist_plot = ggplot2::ggplot() +
	ggplot2::geom_bar(aes(x = item)) +
	ggplot2::stat_bin(breaks = as.numeric(names(choices))) + 
	ggplot2::ggtitle(item_name, subtitle = item_label) + 
	ggplot2::xlab("Choices")

if (dplyr::n_distinct(item) < 13 && 
		is.numeric(type.convert(names(choices), as.is = T)) && 
		any(names(choices) != unlist(choices))) {
	dist_plot = dist_plot + ggplot2::scale_x_continuous("Choices", breaks = as.numeric(names(choices)), labels = unlist(choices))
}

dist_plot
knitr::opts_chunk$set(fig.width = old_width)
```

`r indent`# Summary statistics {#`r item_name`_summary}
```{r}
pander::pander(skimr::skim_v(item))
```

`r indent`# Item {#`r item_name`_item}

```{r}
item_info$label_parsed = item_info$choices = item_info$choice_list = item_info$study_id = item_info$id = NULL
pander::pander(as.data.frame(t(item_info)))
```



`r indent`## Choices {#`r item_name`_choices}
```{r}
if (!is.null(choices)) {
	pander::pander(choices)
}
```

